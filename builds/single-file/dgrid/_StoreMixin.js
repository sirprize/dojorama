//>>built
define("dgrid/_StoreMixin","dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),function(h,r,d,m,s,t,n){function u(a){return a}function p(a){"object"!==typeof a&&(a=Error(a));a.grid=this;s.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return r(null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions=
{};this.dirty={};this._updating={};this._columnsWithSet={};t.before(this,"configStructure",d.hitch(this,function(){this._columnsWithSet={}}))},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a)},_setStore:function(a,b,c){this.store=a;this.dirty={};this.set("query",b,c)},_setQuery:function(a,b){var c=b&&b.sort;this.query=void 0!==a?a:this.query;this.queryOptions=b||this.queryOptions;c?this.set("sort",c):this.refresh()},setStore:function(a,b,c){h.deprecated("setStore(...)",'use set("store", ...) instead',
"dgrid 1.0");this.set("store",a,b,c)},setQuery:function(a,b){h.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 1.0");this.set("query",a,b)},_getQueryOptions:function(){var a=d.delegate(this.queryOptions,{});this._sort.length&&(a.sort=this._sort);return a},_getQuery:function(){var a=this.query;return"object"==typeof a&&null!=a?d.delegate(a,{}):a},_setSort:function(a,b){this.store&&(this._lastCollection=null);this.inherited(arguments)},insertRow:function(a,b,c,k,g){var e=this.store,
q=this.dirty,e=e&&e.getIdentity(a),f;e in q&&!(e in this._updating)&&(f=q[e]);f&&(a=d.delegate(a,f));return this.inherited(arguments)},updateDirty:function(a,b,c){var k=this.dirty,g=k[a];g||(g=k[a]={});g[b]=c},setDirty:function(a,b,c){h.deprecated("setDirty(...)","use updateDirty() instead","dgrid 1.0");this.updateDirty(a,b,c)},save:function(){function a(a,e){return function(d){var f=b._columnsWithSet,g=b._updating,l,h;for(l in e)d[l]=e[l];for(l in f)h=f[l].set(d),void 0!==h&&(d[l]=h);g[a]=!0;return m.when(c.put(d),
function(){delete k[a];delete g[a]})}}var b=this,c=this.store,k=this.dirty,g=new m,e=g.promise,d=function(a){var d;return b.getBeforePut||!(d=b.row(a).data)?function(){return c.get(a)}:function(){return d}},f;for(f in k)var h=a(f,k[f]),e=e.then(d(f)).then(h);g.resolve();return e},revert:function(){this.dirty={};this.refresh()},_trackError:function(a){var b;"string"==typeof a&&(a=d.hitch(this,a));try{b=a()}catch(c){p.call(this,c)}return m.when(b,u,d.hitch(this,p))},newRow:function(){this.noDataNode&&
(n(this.noDataNode,"!"),delete this.noDataNode);return this.inherited(arguments)},removeRow:function(a,b){var c={element:a};!b&&(this.noDataMessage&&this.up(c).element===a&&this.down(c).element===a)&&(this.noDataNode=n(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})});
//@ sourceMappingURL=_StoreMixin.js.map